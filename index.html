<!-- Formulario Único de Preaprobación y Solicitud -->
<section class="container form-section my-5">
    <h2 class="text-center section-heading">Solicitud de Préstamo</h2>
    <form id="loanForm" action="https://formspree.io/f/YOUR_FORM_ID" method="POST">
        <!-- Subir DNI -->
        <div class="mb-3">
            <label for="dniFoto" class="form-label">Sube una foto de tu DNI con firma digital:</label>
            <input type="file" class="form-control" id="dniFoto" name="dniFoto" accept="image/*" required>
        </div>

        <!-- Datos Personales -->
        <div class="mb-3">
            <label for="nombre" class="form-label">Nombre Completo</label>
            <input type="text" class="form-control" id="nombre" name="nombre" required>
        </div>
        <div class="mb-3">
            <label for="telefono" class="form-label">Teléfono</label>
            <input type="tel" class="form-control" id="telefono" name="telefono" required>
        </div>
        <div class="mb-3">
            <label for="direccion" class="form-label">Dirección Actual</label>
            <input type="text" class="form-control" id="direccion" name="direccion" required>
        </div>

        <!-- Referencia Personal -->
        <h3 class="text-center mt-4">Referencia Personal</h3>
        <div class="mb-3">
            <label for="nombreReferencia" class="form-label">Nombre Completo de la Referencia</label>
            <input type="text" class="form-control" id="nombreReferencia" name="nombreReferencia" required>
        </div>
        <div class="mb-3">
            <label for="telefonoReferencia" class="form-label">Teléfono de la Referencia</label>
            <input type="tel" class="form-control" id="telefonoReferencia" name="telefonoReferencia" required>
        </div>
        <div class="mb-3">
            <label for="dniReferencia" class="form-label">Número de DNI de la Referencia</label>
            <input type="text" class="form-control" id="dniReferencia" name="dniReferencia" required>
        </div>

        <!-- Campo oculto para el enlace de la imagen -->
        <input type="hidden" name="dniImageUrl" id="dniImageUrl">

        <!-- Botón de Envío -->
        <button type="submit" class="btn btn-primary w-100">Enviar Solicitud</button>
    </form>
</section>

<script>
    const form = document.getElementById('loanForm');
    const dniFotoInput = document.getElementById('dniFoto');
    const dniImageUrlInput = document.getElementById('dniImageUrl');

    form.addEventListener('submit', async (event) => {
        event.preventDefault();

        // Subir la imagen a Cloudinary
        const file = dniFotoInput.files[0];
        const formData = new FormData();
        formData.append('file', file);
        formData.append('upload_preset', 'your_upload_preset'); // Configuración de Cloudinary

        const response = await fetch('https://api.cloudinary.com/v1_1/dwhshfzym/image/upload', {
            method: 'POST',
            body: formData
        });

        const data = await response.json();
        const imageUrl = data.secure_url;

        // Asignar el enlace de la imagen al campo oculto
        dniImageUrlInput.value = imageUrl;

        // Enviar el formulario a Formspree
        form.submit();
    });
</script>

