<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRESTAMOS CON DNI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Estilos personalizados -->
    <style>
        /* Aquí va tu CSS */
    </style>
</head>
<body>

<!-- Contenido HTML, encabezado, secciones y formulario -->

<section class="container form-section my-5">
    <h2 class="text-center section-heading">Solicitud de Préstamo</h2>
    <form id="loanForm" action="https://formspree.io/f/mzzbgype" method="POST">
        <div class="mb-3">
            <label for="dniFoto" class="form-label">Sube una foto de tu DNI con firma digital:</label>
            <input type="file" class="form-control" id="dniFoto" name="dniFoto" accept="image/*" required>
        </div>
        <!-- Otros campos del formulario -->
        <input type="hidden" name="dniImageUrl" id="dniImageUrl">
        <button type="submit" class="btn btn-primary w-100">Enviar Solicitud</button>
    </form>
</section>

<script>
    const form = document.getElementById('loanForm');
    const dniFotoInput = document.getElementById('dniFoto');
    const dniImageUrlInput = document.getElementById('dniImageUrl');

    form.addEventListener('submit', async (event) => {
        event.preventDefault();

        // Verificar si se ha seleccionado un archivo
        if (dniFotoInput.files.length === 0) {
            alert("Por favor, selecciona una foto de tu DNI.");
            return;
        }

        const file = dniFotoInput.files[0];
        const formData = new FormData();
        formData.append('file', file);
        formData.append('upload_preset', 'unsigned_upload'); // Cambia por tu upload_preset real en Cloudinary

        try {
            const response = await fetch('https://api.cloudinary.com/v1_1/dwhshfzym/image/upload', {
                method: 'POST',
                body: formData
            });

            const data = await response.json();
            
            if (data.secure_url) {
                dniImageUrlInput.value = data.secure_url;
                form.submit();  // Enviar el formulario una vez que la imagen esté subida
            } else {
                alert("Error al subir la imagen. Inténtalo de nuevo.");
            }
        } catch (error) {
            alert("Hubo un error en la carga de la imagen. Por favor, revisa tu conexión.");
        }
    });
</script>

<script>
    // Función para el cálculo de cuotas
    function calculateTotal() {
        let amount = document.getElementById('monto').value;
        document.getElementById('selectedAmount').innerText = amount;
        
        let total = amount * 1.35;
        let dailyPayment = total / 27;

        document.getElementById('totalPagar').value = `AR$ ${total.toFixed(2)}`;
        document.getElementById('cuotaDiaria').value = `AR$ ${dailyPayment.toFixed(2)}`;
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

</body>
</html>


